ğŸ§  NCF-based Recommender System
(Santander Product Recommendation)
ğŸ“Œ Overview

TensorFlow ê¸°ë°˜ Neural Collaborative Filtering (NCF) ì¶”ì²œ ëª¨ë¸ êµ¬í˜„ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.
Kaggle Santander Product Recommendation ë°ì´í„°ë¥¼ í™œìš©í•˜ì—¬,
**ì‚¼ì„±ì „ì íì‡„ë§ í™˜ê²½ì—ì„œ ì‹¤ë¬´ë¡œ ì‚¬ìš©í•œ ì¶”ì²œ ëª¨ë¸ íŒŒì´í”„ë¼ì¸(NCF + BPR Loss)**ì„
ë¡œì»¬ í™˜ê²½ì—ì„œ ì¬í˜„í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•˜ì˜€ìŠµë‹ˆë‹¤.

Dataset: Santander Product Recommendation (Kaggle)

Evaluation: Leave-One-Out (LOO)

Metric: HR@5

Loss: BPR Loss

HR@5: 0.70 (ìƒ˜í”Œ ìœ ì € 500ëª… ê¸°ì¤€)

âš™ï¸ Architecture
NCF.py
â”œâ”€â”€ get_long_df()              # ë°ì´í„° ë¡œë“œ ë° wide â†’ long ë³€í™˜
â”œâ”€â”€ preprocess_long_df()       # ìœ ì € / ì•„ì´í…œ ID ë§¤í•‘
â”œâ”€â”€ build_user_sequences()     # ìœ ì €ë³„ ì‹œí€€ìŠ¤ ìƒì„±
â”œâ”€â”€ make_train_test()          # Leave-One-Out ë¶„í• 
â”œâ”€â”€ NCF                        # User/Item Embedding + MLP
â”œâ”€â”€ train_model()              # BPR Loss + Negative Sampling
â”œâ”€â”€ hitrate_at_k()             # HR@5 í‰ê°€
â”œâ”€â”€ save_recommendations()     # ì¶”ì²œ ê²°ê³¼ CSV ì €ì¥
â””â”€â”€ save_hits_ncf()            # ìœ ì € ë‹¨ìœ„ hit(0/1) ì €ì¥


User / Item Embedding ê¸°ë°˜ MLP êµ¬ì¡°

BPR Loss + Negative Sampling = 5

HR@5 ê¸°ì¤€ Early Stopping ì ìš©

ìœ ì € ë‹¨ìœ„ hit ê²°ê³¼ë¥¼ ì €ì¥í•˜ì—¬ ì¶”ê°€ ë¶„ì„ ê°€ëŠ¥

ğŸ”¬ Model Validation (Offline A/B Test)

ë³¸ í”„ë¡œì íŠ¸ì—ì„œëŠ” NCF ëª¨ë¸ì˜ ì„±ëŠ¥ ê²€ì¦ì„ ìœ„í•´,
íŠ¸ë¦¬ ê¸°ë°˜ ì¶”ì²œ ë² ì´ìŠ¤ë¼ì¸(XGBoost ê¸°ë°˜ ëª¨ë¸)ê³¼ì˜
ì˜¤í”„ë¼ì¸ A/B í…ŒìŠ¤íŠ¸ë¥¼ ì¶”ê°€ë¡œ ìˆ˜í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.

âš ï¸ ë¹„êµ ëª¨ë¸(XGBoost) ì½”ë“œëŠ” ë³¸ ë ˆí¬ì§€í† ë¦¬ì—ëŠ” í¬í•¨í•˜ì§€ ì•Šì•˜ìœ¼ë©°,
ë™ì¼í•œ ë°ì´í„° ë¶„í•  ë° í‰ê°€ ì¡°ê±´ í•˜ì—ì„œ ì„±ëŠ¥ ê²€ì¦ ìš©ë„ë¡œë§Œ í™œìš©ë˜ì—ˆìŠµë‹ˆë‹¤.

âœ” ë¹„êµ ì¡°ê±´

ë™ì¼ ì‚¬ìš©ì ê¸°ì¤€

ë™ì¼ Leave-One-Out í…ŒìŠ¤íŠ¸ ì•„ì´í…œ

ë™ì¼ í›„ë³´ ì•„ì´í…œ í’€

ë™ì¼ í‰ê°€ ì§€í‘œ (HR@5)

ê° ì‚¬ìš©ìë³„ **HR@5 hit ì—¬ë¶€(0/1)**ë¥¼ í‘œë³¸ìœ¼ë¡œ í•˜ì—¬
ëŒ€ì‘í‘œë³¸ í†µê³„ ê²€ì •ì„ ìˆ˜í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.

âœ” Statistical Test

Paired t-test

Wilcoxon signed-rank test

âœ” Result (Example)

NCF HR@5 = 0.70

Baseline HR@5 = 0.63

Mean Difference = +0.07

p-value = 0.03412159030060471 < 0.05

ì´ë¥¼ í†µí•´ ë‹¨ìˆœ í‰ê·  ì„±ëŠ¥ ë¹„êµê°€ ì•„ë‹Œ,
ë™ì¼ ì‚¬ìš©ì ê¸°ì¤€ì—ì„œ NCF ëª¨ë¸ì˜ ì„±ëŠ¥ ê°œì„ ì´ í†µê³„ì ìœ¼ë¡œ ìœ ì˜í•¨ì„ ê²€ì¦í•˜ì˜€ìŠµë‹ˆë‹¤.

ğŸ“Š Additional Notes

**í†µê³„ ê¸°ë°˜ ì¶”ì²œ(Popularity / Co-occurrence ë“±)**ì€
ì‹¤ì œ ì‚¼ì„±ì „ì ì‹¤ë¬´ íŒŒì´í”„ë¼ì¸ì—ì„œëŠ” í•¨ê»˜ ì‚¬ìš©ë˜ì—ˆìœ¼ë‚˜,
ë³¸ í”„ë¡œì íŠ¸ì—ì„œëŠ” ë°ì´í„° ìš©ëŸ‰ì´ ë§¤ìš° ì»¤
í•™ìŠµ ë° ì‹¤í—˜ íš¨ìœ¨ì„ ê³ ë ¤í•˜ì—¬ ì œì™¸í•˜ì˜€ìŠµë‹ˆë‹¤.

ëŒ€ì‹  ë³¸ êµ¬í˜„ì—ì„œëŠ”
NCF (Embedding + MLP) + BPR Loss + Negative Sampling êµ¬ì¡°ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ
í•µì‹¬ ì¶”ì²œ ë¡œì§ì„ ì¬í˜„í•˜ëŠ” ë° ì§‘ì¤‘í•˜ì˜€ìŠµë‹ˆë‹¤.

ì¶”í›„ ë°ì´í„°ì…‹ ê²½ëŸ‰í™” ë˜ëŠ” ìƒ˜í”Œë§ì„ ì ìš©í•  ê²½ìš°,
í†µê³„ ê¸°ë°˜ ì¶”ì²œì„ ê²°í•©í•œ Hybrid Recommendation Systemìœ¼ë¡œ í™•ì¥ ê°€ëŠ¥í•©ë‹ˆë‹¤.

ğŸ“Œ Model Selection Rationale

BERT4Recì€ ì‹œí€€ìŠ¤ ê¸°ë°˜ ëª¨ë¸ì´ì§€ë§Œ,
ì‚¼ì„±ì „ì VOC ë°ì´í„° íŠ¹ì„±ìƒ ì•„ì´í…œ ê°„ ëª…í™•í•œ ë¬¸ë§¥(sequence dependency)ì´
ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤ê³  íŒë‹¨í•˜ì—¬ ë³¸ í”„ë¡œì íŠ¸ì—ì„œëŠ” ì œì™¸í•˜ì˜€ìŠµë‹ˆë‹¤.

ì´ì— ë”°ë¼,
ì‚¬ìš©ìâ€“ì•„ì´í…œ ìƒí˜¸ì‘ìš©ì— ì§‘ì¤‘í•˜ëŠ” NCF êµ¬ì¡°ë¥¼ ìµœì¢… ì„ íƒí•˜ì˜€ìŠµë‹ˆë‹¤.

ğŸš€ Future Work

HR@10 / NDCG@10 ë“± ì¶”ê°€ ì§€í‘œ í‰ê°€

ìƒ˜í”Œ ìˆ˜ í™•ì¥ ë° seed ë°˜ë³µ ì‹¤í—˜

í†µê³„ ê¸°ë°˜ ì¶”ì²œê³¼ ê²°í•©í•œ Hybrid êµ¬ì¡°

ì˜¨ë¼ì¸ A/B í…ŒìŠ¤íŠ¸ë¡œì˜ í™•ì¥ ê°€ëŠ¥ì„± ê²€í† 

ğŸ”‘ Summary

ì‚¼ì„±ì „ì ì‹¤ë¬´ì—ì„œ ì‚¬ìš©ëœ NCF + BPR Loss ì¶”ì²œ íŒŒì´í”„ë¼ì¸ì„ ì¬í˜„í•˜ê³ ,
ì˜¤í”„ë¼ì¸ A/B í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ ì‚¬ìš©ì ë‹¨ìœ„ ì„±ëŠ¥ ê°œì„ ì„ í†µê³„ì ìœ¼ë¡œ ê²€ì¦í•œ í”„ë¡œì íŠ¸
